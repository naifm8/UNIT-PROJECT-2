{% extends 'base.html' %}
{% block title %}Inbox{% endblock %}
{% load static %}

{% block content %}
<div class="container py-5">
  <h2 class="mb-4">Inbox</h2>

  <div class="row">
    <div class="col-md-6">
      <h4 class="mb-3">Received Messages</h4>
      {% for msg in received_messages %}
        <div class="card mb-3 {% if not msg.is_read %}border-warning{% endif %}">
          <div class="card-body">
            <h5 class="card-title">{{ msg.subject }}</h5>
            <p class="card-text">{{ msg.content }}</p>
            <p class="card-text">
              <strong>From:</strong> {{ msg.sender.get_full_name }}
              <small class="text-muted">({{ msg.sent_at|date:"M d, Y H:i" }})</small>
            </p>
            
            {% if not msg.is_read %}
              <span class="badge bg-warning text-dark">Unread</span>
            {% endif %}
      
            <a href="{% url 'academy:send_message' msg.sender.id %}" class="btn btn-sm btn-outline-secondary mt-2">Reply</a>
          </div>
        </div>
      {% empty %}
        <p class="text-muted">No received messages.</p>
      {% endfor %}
    </div>

    <div class="col-md-6">
      <h4 class="mb-3">Sent Messages</h4>
      {% for msg in sent_messages %}
        <div class="card mb-3">
          <div class="card-body">
            <h5 class="card-title">{{ msg.subject }}</h5>
            <p class="card-text">{{ msg.content }}</p>
            <p class="card-text">
              <strong>To:</strong> {{ msg.recipient.get_full_name }}
              <small class="text-muted">({{ msg.sent_at|date:"M d, Y H:i" }})</small>
            </p>
          </div>
        </div>
      {% empty %}
        <p class="text-muted">No sent messages.</p>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}

